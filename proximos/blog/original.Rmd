---
title: "Tutorial - Violin + Box Plot"
author: "Isabella Bicalho Frazeto"
date: "9/6/2021"
output: html_document
---



# Introdução

Esse mini-tutorial visa ensinar a como plotar box plot e o violin plot no mesmo gráfico usando o ggplot2. Nas sessões 1 e 2 mostramos o que é um box plot e um violin plot e discutimos um pouco sobre suas vantagens. Na sessão três, mostramos como plotar os dois juntos.

## Box plot
Boxplot, diagrama de caixa, ou diagrama de quartis, ou meu favorito, gráfico de caixa de bigodes, é um gráfico que permite visualizar como o seu conjunto de dados está distribuído. É um gráfico  clássico em que mediana é o centro da caixa e o primeiro quartil e o terceiro formam o retângulo. Por último, bigodes da caixa são formados pelo limite inferior e o limite superior. Tipicamente, os outliers são representados por pequenos pontos no gráfico. Do wikipedia: 

![Box-plot](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/Elements_of_a_boxplot_pt.svg/1920px-Elements_of_a_boxplot_pt.svg.png)
Por CEPID NeuroMat, CC BY-SA 4.0, https://commons.wikimedia.org/w/index.php?curid=56047497

## Violin plot

Violin plot é uma visualização similar a um box plot, porém ela tem a vantagem de usar um kernel de densidade simétrico em cada lado.  Ou seja, ela também consegue refletir a densidade de probabilidade (ou em outras palavras, aquela linha que costuma estar cima dos histogramas). A maior vantagem é que ela consegue ser mais informativa que um simples diagrama de caixa porque ela mostra o seu conjunto inteiro de dados. Infelizmente, não é um gráfico tão popular o que pode gerar um pouco de confusão sobre sua interpretação. Também do wikipedia:

![](https://upload.wikimedia.org/wikipedia/commons/3/3a/Violin_plot.gif)

Por itl.nist.gov - VIOLIN PLOT at www.itl.nist.gov, Public Domain, https://commons.wikimedia.org/w/index.php?curid=4992563


## Por que usar ambos juntos?

O pulo do gato é que você plotar ambos no mesmo gráfico. Esse reflexo é especialmente importante se seus dados são multimodais porque isso fica evidente usando o violin plot e não é claro no box plot. Outra vantagem é que isso evita também que você acabe com um box plot, um histograma + estimativa de densidade kernel para cada variável. Pela própria natureza dos gráficos, é também mais fácil de visualizar a sua amostra por fatores diferentes. 

## Tutorial

Primeiro passo é carregar o pacote do ggplot e o dataset que vamos usar. Aqui, vamos usar dos data sets diferentes: plantGrowth e beavers. PlantGrowth contém duas colunas com o peso e o grupo. 

```{r}
library(datasets)
library(ggplot2)
data("PlantGrowth")
data("InsectSprays")
head(PlantGrowth)
```


Insect Sprays é o resultado de um experimento que visava saber qual seria o spray mais efetivo. Possui duas colunas: count (quantidade) e spray.

```{r}
head(InsectSprays)
```
  
## PlantGrowth

Usando ggplot2, você pode plotar dois gráficos diretamente usando apenas "somando" dois objetos geométricos diferentes, mas o resultado não é muito simpático.  
  
```{r}
ggplot(PlantGrowth, aes(x=weight, y=group, color = group)) + 
        geom_violin() +
        geom_boxplot() 
```
  
  
O primeiro passo é mudar a largura dos boxplots. Para isso, passamos o width = 0.3 como parãmetro dentro da chamada do boxplot. Também mudados o tema usando theme_light para o gráfico ficar mais coeso. 
  
```{r}
ggplot(PlantGrowth, aes(x=weight, y=group, color = group)) + 
  theme_light() +
  geom_violin() +
  geom_boxplot(width=0.3) 
```
  
Por último, você pode escolher colocar o gráfico "de pé". Nesse caso, basta pedir para que as coodernadas sejam invertidas usando coord_flip().
  
```{r}
ggplot(PlantGrowth, aes(x=weight, y=group, color = group)) + 
  theme_light() +
  geom_violin() +
  geom_boxplot(width=0.3) +
  coord_flip()
```



## Insect Sprays
Podemos fazer a mesma coisa usando o dataset InsectSprays.

```{r}
ggplot(InsectSprays, aes(x=spray, y=count, color = spray)) + 
  theme_light() +
  geom_violin() +
  geom_boxplot(width=0.05) 
```
  
© 2021 GitHub, Inc.
Terms
Privacy
Security
Status
Docs
Contact GitHub
Pricing
API
Training
Blog
About
