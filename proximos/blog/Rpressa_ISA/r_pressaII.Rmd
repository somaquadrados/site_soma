---
title: "R para quem tem pressa"
author: "Isabella Bicalho Frazeto"
date: "28/03/2021"
output: html_document
---

# R para quem tem pressa: Parte II

## (ou R para quem n√£o quer aprender R)

![](narutorun.gif)

Esse tutorial √© para voc√™ que precisa aprender **R** por algum motivo de for√ßa maior, n√£o sabe absolutamente nada sobre e precisa de um lugar para come√ßar. O objetivo aqui *n√£o* √© te ensinar a programar, muito menos te ensinar a fazer an√°lises estat√≠sticas, mas sim te ensinar um pouco sobre o R, o pipe e como manipular um dataframe.

## O que voc√™ precisa para seguir esse tutorial?

Esse tutorial vem acompanhado de Rmarkdown (um "editor de texto" que possibilita a inclus√£o de c√≥digos de programa√ß√£o em R dentro dele). O markdown e a tabela que usaremos est√£o dispon√≠veis no meu [GitHub](https://github.com/bellabf/r_pressa) ([O que √© um GitHub?](https://www.somaquadrados.com/blog/git/github/)). Como pr√©-requisitos voc√™ precisa [instalar o R, o Rstudio](https://didatica.tech/como-instalar-a-linguagem-r-e-o-rstudio/) e possuir um *tico* (ü§è) de disposi√ß√£o.

## Por que R?

R √© uma linguagem *open-source* (= voc√™ n√£o precisa pagar uma licen√ßa para us√°-la). O importante √© que, al√©m do que vem com a instala√ß√£o do R (o que costumamos chamar de *R base*), existe a possibilidade de aumentar a usabilidade da linguagem com o uso de *pacotes*¬π. Podemos pensar no R como um super Excel (üí™) capaz de lidar com problemas ligeiramente mais complicados de uma maneira mais eficiente.

## Pacotes üì¶

Um pacote √© uma conven√ß√£o para organizar, padronizar e distribuir **fun√ß√µes** extras do R. A principal motiva√ß√£o para criar um pacote √© organizar e compartilhar fun√ß√µes de m√©todos e/ou implementa√ß√µes rec√©m-criadas que sejam √∫teis para outras pessoas.

<center>

![](pacote.png){width="329"}

</center>

Parte do apelo ao R √© justamente a flexibilidade das diferentes ferramentas dispon√≠veis em cada um de seus pacotes. Aqui, usaremos dois ([magrittr](https://magrittr.tidyverse.org/) e [dplyr](https://dplyr.tidyverse.org/)), ambos parte do framework do **‚ú®**[Tidyverse](https://www.tidyverse.org/)**‚ú®**.

![](tidyverse.png){width="512"}

O Tidyverse √© uma cole√ß√£o obstinada de pacotes R projetados para ci√™ncia de dados, ou seja, seus pacotes compartilham uma filosofia de design, gram√°tica e estruturas de dados subjacentes. Neste universo magn√≠fico, magrittr e dplyr s√£o considerados essenciais. Al√©m disso, √© poss√≠vel destacar dois pontos:

1.  Muito do apelo comercial do R vem do tidyverse!
2.  Aprender dplyr te coloca um passo mais pr√≥ximo de aprender [SQL (uma linguagem de banco de dados amplamente usada)](https://pt.wikipedia.org/wiki/SQL).

### Instalar e carregar o Tidyverse

Para instalar um pacote em R, executamos a fun√ß√£o `install.packages("nome_do_pacote")`.

> ‚ö†Ô∏èNome do pacote **entre aspas**!! ‚ö†Ô∏è

```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
install.packages("tidyverse")
```

Ap√≥s a instala√ß√£o do tidyverse, √© necess√°rio invoca-lo para uso de suas fun√ß√µes. Para isso, usamos a fun√ß√£o `library(nome_do_pacote)`.

> ‚ö†Ô∏è Nome do pacote **sem aspas**!! ‚ö†Ô∏è

```{r}
library(tidyverse)
```

> ‚ö†Ô∏è Ao invocar o Tidyverse, o pacote Dplyr √© carregado automaticamente. Voc√™ tamb√©m pode executar diretamente `library(dplyr)` se quiser üë©‚Äçüíª.

FALAR SOBRE PACOTE::FUNCAO() AQUI??

## Pipe

FALAR DO PACOTE magrittr E ENT√ÉO DO PIPE..

O tidyverse tem mais um s√≠mbolo "%\>%" ou "\|\>": o pipe. Ele permite agrupar v√°rias opera√ß√µes que seriam realizadas separadamente em um √∫nica opera√ß√£o de maneira mais intuitiva.

Fazer empanadas **sem** o pipe:

```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
enfriarse(
  hornear(
    cerrar_la_masa(
      agregar_relleno(
        abre_la_massa(
          mezclar(
            hacer_la_masa(rep(farina, 5), manteca, sal, agua_tibia),
            hasta = 'masa homog√©nea'),
          tipo = "carne picada"),
      ),
    ),
    temperatura = 180, tiempo = 20),
)
```

Fazer empanadas **com** o pipe:

```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
hacer_la_masa(rep(farina, 5), manteca, sal, agua_tibia) %>%
  mezclar(hasta = 'masa homog√©nea') %>%
  abre_la_massa() %>%
  agregar_relleno(tipo = "carne picada") %>%
  cerrar_la_masa() %>%
  hornear(temperatura = 180, tiempo = 20) %>%
  enfriarse()
```

> ‚ö†Ô∏è Todos os comandos que usaremos nesse tutorial ser√£o escritos com o pipe (%\>%).

## Importando dados para o R

Na [vers√£o I](incluirlink) deste tutorial voc√™ aprendeu a lidar com vetores e listas. Nesta parte II vamos aprender como importar e gerenciar dataframes. Lembrando que dataframes s√£o objetos bidimensionais e que podem conter uma classe de valor por coluna.

![](excel2.png){width="327"}

Para facilitar sua vida - e sua transi√ß√£o para o R - aconselhamos que voc√™ crie suas planilhas diretamente em um editor externo (como Excel ou Google Sheets) e depois importe-as para o R. Para isso, algumas boas pr√°ticas s√£o recomendadas:

-   As vari√°veis v√£o em colunas - uma coluna por vari√°vel.

-   Unidades observacionais ou experimentais v√£o nas linhas.

-   Incluir apenas um valor por c√©lula (coluna vs. linha = 1 valor).

    ![](bp.png)

-   Evite usar caracteres especiais ou espa√ßo no nome de colunas. Exemplo: prefira **endereco** no lugar de **endere√ßo** e **dia_coleta** no lugar de **dia coleta**.

-   N√£o preencha valores faltantes (os famosos NA's) com zeros.

-   Salve suas planilhas em formato **.csv**, **.tsv** ou em **.txt**. Isso facilita a importa√ß√£o para o R.

-   N√£o coloque coment√°rios ou a unidade m√©trica nos seus dados.

    -   Dica: se voc√™ estiver medindo algo em cent√≠metros, nomeie a coluna como **nomevariavel_cm**.

-   Para vari√°veis categ√≥ricas nominais, verifique se os nomes correspondentes √† mesma caracter√≠stica est√£o escritos da mesma forma. Se, por exemplo, voc√™ est√° nomeando pa√≠ses e escreve Brasil de duas formas diferentes (numa linha Brasil e em outra brasil), R entender√° que s√£o valores distintos.

-   Quando analisamos dados, geralmente trabalhamos com objetos de duas dimens√µes (linhas vs. colunas). Por isso, ao preencher uma planilha, lembre-se de usar apenas uma aba do seu editor; caso contr√°rio, voc√™ ter√° que despender um esfor√ßo mais significativo para importar e juntar os dados.

-   N√£o sublinhe ou use cores em sua planilha; essas formata√ß√µes n√£o s√£o import√°veis ao R.

### Iris

Neste tutorial, trabalharemos com uma famosa planilha de dados - a **iris.csv** - que obedece a todas as regras e dicas pr√©-estabelecidas ([baixe aqui](https://github.com/bellabf/r_pressa)). Ao baixar a **iris.csv**, salve-a na mesma pasta do seu computador que est√° sendo mantindo o seu script R. Voc√™ pode verificar qual √© o endere√ßo deste diret√≥rio com o seguinte comando:

```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
getwd()
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
print("C:/user/docs/rpressa")
```

O conjunto de dados de √≠ris fornece as medidas (em cent√≠metros) do comprimento e largura da s√©pala e da p√©tala para tr√™s esp√©cies de ir√≠s (Setosa, Versicolor e Virginia), totalizando 150 indiv√≠duos.

![](https://machinelearninghd.com/wp-content/uploads/2021/03/iris-dataset.png){width="660"}

Ap√≥s salvar a planilha no seu diret√≥rio, voc√™ deve usar a fun√ß√£o `read.csv('nome_planilha.csv')` para importar a iris ao R.

```{r}
iris <- read.csv("iris.csv")
```

Ao chamar o nome da tabela "iris", R exibir√° seu conte√∫do: quatro colunas contendo as medidas das s√©palas (sepal.length e sepal.width) e p√©talas (petal.length e petal.width), uma coluna contendo o nome das esp√©cies de √≠ris (species) e 150 linhas referentes aos indiv√≠duos florais medidos.

```{r eval=FALSE, message=FALSE, warning=FALSE, include=TRUE}
iris
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)
library(tidyverse)
iris %>% 
  kbl() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
  scroll_box(height = "300px")
```

## Manipulando um dataframe com o dplyr

O **dplyr** √© um pacote projetado para a manipula√ß√£o de **dataframes**. Suas fun√ß√µes permitem que o gerenciamento de dados seja intuitivo e amig√°vel.

![](https://miro.medium.com/max/1400/1*NXRsFH_12sfj79W-P4qI0Q.png){width="596"}

O dplyr trabalha com uma gram√°tica de manipula√ß√£o de dados na qual os verbos ditam certas a√ß√µes. Cada verbo tem a sua fun√ß√£o equivalente. Os verbos mais comuns s√£o:

#### MUTATE

    Adiciona novas var√≠aveis em fun√ß√£o de outras (como, por exemplo, percentagem).

INCLUIR O C√ìDIGO EM R

#### SELECT

    Seleciona vari√°veis baseada no nome.

INCLUIR O C√ìDIGO EM R

#### FILTER

    Seleciona vari√°veis baseada em valores.

INCLUIR O C√ìDIGO EM R

#### SUMMARIZE

    Resume variav√©is em valores √∫nicos (como m√©dia).

INCLUIR O C√ìDIGO EM R

**GROUP BY**

EXPLICACAO

USO

#### ARRANGE

    Orderna as linhas da tabela.

INCLUIR O C√ìDIGO EM R

## Exemplo 1 - sumarizando dados

Voc√™, pesquisador da √°rea de bot√¢nica, deseja obter o tamanho m√©dio das s√©palas e p√©talas da √≠ris. Para isso, voc√™ pode usar a fun√ß√£o `summarise(nome_coluna = mean(coluna))`:

```{r}
iris %>%
  summarise(mean_sepal = mean(Sepal.Length), 
  mean_petal = mean(Petal.Length))
```

O problema √© que existem tr√™s esp√©cies de ir√≠s, e voc√™ quer saber a m√©dia de cada uma delas. Para isso voc√™ pode combinar a fun√ß√£o `group_by(coluna_grupos)` (que ir√° agrupar as esp√©cies) com o `summarise(nome_coluna = mean(coluna))` (que vai calcular a m√©dia).

```{r}
iris %>%
  group_by(Species) %>%
  summarise(mean_sepal = mean(Sepal.Length), 
  mean_petal = mean(Petal.Length))
```

Por fim, voc√™ pode incluir uma medida de variabilidade para acompanhar a sua m√©dia. Como de costume em artigos cient√≠ficos e relat√≥rios, voc√™ pode usar o desvio padr√£o.

```{r}
iris %>%
  group_by(Species) %>%
  summarise(mean_sepal = mean(Sepal.Length), 
            mean_petal = mean(Petal.Length), 
            sd_sepal = sd(Sepal.Length),
            sd_petal = sd(Petal.Length))
```

### Salvando seus dados

Se voc√™ deseja salvar a tabela contendo a m√©dia e o desvio padr√£o em um arquivo import√°vel para excel, a primeira coisa que voc√™ precisa fazer √© atribuir toda a fun√ß√£o constru√≠da ao nome de um objeto:

```{r}
tab <- iris %>%
  group_by(Species) %>%
  summarise(mean_sepal = mean(Sepal.Length), 
            mean_petal = mean(Petal.Length), 
            sd_sepal = sd(Sepal.Length),
            sd_petal = sd(Petal.Length))
```

Por √∫ltimo, voc√™ pode exportar a sua tabela usando a fun√ß√£o `write.csv(objeto, "nome_objeto.csv")`.

```{r}
write.csv(medias_especies, "medias_especies.csv")
```

## Exemplo II: Selecionar, filtrar e reordenar os valores de iris

INCLUIR UM EXEMPLO SELECIONANDO S√ì COLUNAS DESEJADAS, FILTRANDO POR ESP√âCIE E ORDENANDO VALORES DE PETALA OU SELAPA EM ORDEM CRESCENTE.

# FIM! üèÉ

Espero que a sua experi√™ncia tenha sido remotamente agrad√°vel e que voc√™ tenha menos medo de se aventurar no R üíô. No pr√≥ximo tutorial, DESCREVER O QUE TER√Å NO PR√ìXIMO.
